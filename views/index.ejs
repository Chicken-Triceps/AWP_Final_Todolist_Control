<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title><%= title %></title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <div id="user-status" style="margin-bottom: 20px;">
        <% if (user) { %>
            <h2>🎉 환영합니다, <%= user.nickname %>님!</h2>
            <a href="/auth/logout">로그아웃</a>
        <% } else { %>
            <h2>로그인/회원가입이 필요합니다.</h2>
            <a href="/login">로그인</a> | <a href="/join">회원가입</a>
        <% } %>
    </div>
    <hr>

    <% if (user) { %>
        <div class="calendar-container">
            <div class="calendar-header">
                <a href="/?year=<%= prevYear %>&month=<%= prevMonth %>" class="nav-btn">&lt; 이전 달</a>
                <span><%= year %>년 <%= month %>월</span>
                <a href="/?year=<%= nextYear %>&month=<%= nextMonth %>" class="nav-btn">다음 달 &gt;</a>
            </div>

            <div class="calendar-grid">
                <div class="day-name">일</div>
                <div class="day-name">월</div>
                <div class="day-name">화</div>
                <div class="day-name">수</div>
                <div class="day-name">목</div>
                <div class="day-name">금</div>
                <div class="day-name">토</div>

                <% for(let i = 0; i < startDayOfWeek; i++) { %>
                    <div class="day empty"></div>
                <% } %>

                <% for(let day = 1; day <= totalDays; day++) { %>
                    <% 
                        // 오늘 날짜인지 확인
                        let isToday = (year == realYear && month == realMonth && day == realDate);
                        
                        // 공휴일인지 확인 (키 형식: 'YYYY-M-D')
                        let holidayKey = year + '-' + month + '-' + day;
                        let holidayName = holidays[holidayKey]; 
                        let isHoliday = holidayName ? true : false;

                        // 일요일 확인
                        let currentDayOfWeek = (startDayOfWeek + day - 1) % 7;
                        let isSunday = (currentDayOfWeek === 0);
                    %>

                    <div class="day <%= isToday ? 'today' : '' %> <%= (isHoliday || isSunday) ? 'holiday' : '' %>">
                        <span class="date-num"><%= day %></span>
                        
                        <% if (isHoliday) { %>
                            <span class="holiday-name"><%= holidayName %></span>
                        <% } %>
                    </div>
                <% } %>
            </div>
        </div>
    <% } else { %>
        <div style="text-align: center; margin-top: 50px;">
            <h3>캘린더를 보려면 로그인해주세요.</h3>
        </div>
    <% } %>

</body>
</html>